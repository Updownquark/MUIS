
<grammar>
	<entity name="number" order="2" impl="prisms.lang.types.ParsedNumber">
		<option>
			<literal storeAs="neg">-</literal>
		</option>
		<select>
			<option>
				<charset pattern="[1-9][_0-9]*" storeAs="integer" />
				<whitespace type="forbid" />
				<literal>.</literal>
				<option>
					<whitespace type="forbid" />
					<charset pattern="[0-9][_0-9]*" storeAs="fractional" />
				</option>
			</option>
			<option>
				<literal>.</literal>
				<whitespace type="forbid" />
				<charset pattern="[0-9][_0-9]*" storeAs="fractional" />
			</option>
			<option>
				<charset pattern="[1-9][_0-9]*" storeAs="integer" />
			</option>
			<option>
				<literal storeAs="integer">0</literal>
			</option>
		</select>
		<option>
			<literal pattern="[eE]" />
			<option>
				<literal storeAs="expNeg">-</literal>
			</option>
			<charset pattern="[1-9][_0-9]*" storeAs="exp" />
		</option>
		<option>
			<literal pattern="[fF]" storeAs="floatType" />
			<forbid>
				<whitespace type="forbid" />
				<charset pattern="[_a-zA-Z0-9]" />
			</forbid>
		</option>
		<option>
			<literal pattern="[lL]" storeAs="longType" />
			<forbid>
				<whitespace type="forbid" />
				<charset pattern="[_a-zA-Z0-9]" />
			</forbid>
		</option>
	</entity>
	<entity name="hex int" order="1" impl="prisms.lang.types.ParsedNumber">
		<literal storeAs="hex">0x</literal>
		<whitespace type="forbid" />
		<charset pattern="[_0-9a-fA-F]+" storeAs="value" />
		<option>
			<literal pattern="[lL]" storeAs="longType" />
		</option>
		<forbid>
			<whitespace type="forbid" />
			<charset pattern="[_a-zA-Z0-9]" />
		</forbid>
	</entity>
	<entity name="octal int" order="1" impl="prisms.lang.types.ParsedNumber">
		<literal storeAs="oct">0</literal>
		<whitespace type="forbid" />
		<charset pattern="[_0-9]+" storeAs="value" />
		<option>
			<literal pattern="[lL]" storeAs="longType" />
			<forbid>
				<whitespace type="forbid" />
				<charset pattern="[_a-zA-Z0-9]" />
			</forbid>
		</option>
	</entity>
	<entity name="binary int" order="1" impl="prisms.lang.types.ParsedNumber">
		<literal storeAs="binary">0b</literal>
		<whitespace type="forbid" />
		<charset pattern="[_0-9]*" storeAs="value" />
		<option>
			<literal pattern="[lL]" storeAs="longType" />
			<forbid>
				<whitespace type="forbid" />
				<charset pattern="[_a-zA-Z0-9]" />
			</forbid>
		</option>
	</entity>
	<entity name="boolean" order="1" impl="prisms.lang.types.ParsedBoolean">
		<select>
			<option>
				<charset pattern="[_a-zA-Z][_a-zA-Z0-9]*" storeAs="value">
					<match>true</match>
				</charset>
			</option>
			<option>
				<charset pattern="[_a-zA-Z][_a-zA-Z0-9]*" storeAs="value">
					<match>false</match>
				</charset>
			</option>
		</select>
	</entity>

	<op name="type" order="999" impl="TODO">
		<option>
			<op type="identifier" storeAs="namespace" />
			<literal>:</literal>
		</option>
		<op type="identifier" storeAs="name" />
	</op>
	<operator name="section" order="0" impl="TODO">
		<option min="0">
			<select>
				<option>
					<op type="type-set" name="filter" />
				</option>
				<option>
					<op type="group-set" name="filter" />
				</option>
				<option>
					<op type="state" name="filter" />
				</option>
			</select>
		</option>
		<op type="block" name="content" />
	</operator>
	<operator name="block" order="1" impl="prisms.lang.types.ParsedStatementBlock">
		<literal>{</literal>
		<option min="0">
			<select>
				<option>
					<op type="assignment" storeAs="content" />
				</option>
				<option>
					<op type="section" storeAs="subContent" />
				</option>
			</select>
			<option>
				<literal>;</literal>
			</option>
		</option>
		<literal>}</literal>
	</operator>
	<operator name="type-set" order="1" impl="TODO">
		<literal>[</literal>
		<op type="type" storeAs="type" />
		<option min="0">
			<literal>,</literal>
			<op type="type" storeAs="type" />
		</option>
		<literal>]</literal>
	</operator>
	<operator name="group-set" order="1" impl="TODO">
		<literal>(</literal>
		<op type="identifier" storeAs="group" />
		<option min="0">
			<literal>,</literal>
			<op type="identifier" storeAs="group" />
		</option>
		<literal>)</literal>
	</operator>
	<operator name="state" order="1" impl="TODO">
		<literal>.</literal>
		<op type="identifier" storeAs="name" />
		<option min="0">
			<literal>_</literal>
			<op type="identifier" storeAs="name" />
		</option>
	</operator>
	<operator name="assignment" order="1" impl="TODO">
		<option>
			<op type="type" storeAs="domain" />
			<literal>.</literal>
		</option>
		<op type="identifier" storeAs="name" />
		<literal>=</literal>
		<!-- TODO the actual value -->
	</operator>
	
	<entity name="primitive" order="998" impl="prisms.lang.types.ParsedKeyword">
		<charset pattern="[_a-zA-Z][_a-zA-Z0-9]*" storeAs="name">
			<!--<match>void</match>-->
			<match>null</match>
			<!--<match>boolean</match>-->
			<match>true</match>
			<match>false</match>
			<!--<match>char</match>
			<match>byte</match>
			<match>short</match>
			<match>int</match>
			<match>long</match>
			<match>float</match>
			<match>double</match>-->
		</charset>
	</entity>
	<entity name="identifier" order="1000" impl="prisms.lang.types.ParsedIdentifier">
		<charset pattern="[_a-zA-Z][_a-zA-Z0-9\-]*" storeAs="name" />
	</entity>

	<!-- Ternary conditional -->
	<operator name="conditional" order="50" priority="110"
		impl="prisms.lang.types.ParsedConditional">
		<pre-op storeAs="condition" />
		<literal>?</literal>
		<op storeAs="affirmative" />
		<literal>:</literal>
		<op storeAs="negative" />
	</operator>

	<!-- Logical -->
	<operator name="or" order="50" priority="120"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">||</literal>
		<op />
	</operator>
	<operator name="and" order="50" priority="130"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&amp;&amp;</literal>
		<op />
	</operator>

	<!-- Bitwise -->
	<operator name="binary or" order="50" priority="140"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">|</literal>
		<op />
	</operator>
	<operator name="binary xor" order="50" priority="150"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">^</literal>
		<op />
	</operator>
	<operator name="binary and" order="50" priority="160"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&amp;</literal>
		<op />
	</operator>

	<!-- Equality -->
	<operator name="equal" order="50" priority="170"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">==</literal>
		<op />
	</operator>
	<operator name="not equal" order="50" priority="170"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">!=</literal>
		<op />
	</operator>

	<!-- Comparison -->
	<operator name="less than" order="50" priority="180"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&lt;</literal>
		<op />
	</operator>
	<operator name="less than equal" order="50" priority="180"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&lt;=</literal>
		<op />
	</operator>
	<operator name="greater than" order="50" priority="180"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&gt;</literal>
		<op />
	</operator>
	<operator name="greater than equal" order="50" priority="180"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">&gt;=</literal>
		<op />
	</operator>

	<!-- Additive -->
	<operator name="add" order="50" priority="200"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">+</literal>
		<op />
	</operator>
	<operator name="subtract" order="50" priority="200"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">-</literal>
		<op />
	</operator>

	<!-- Multiplicative -->
	<operator name="multiply" order="50" priority="210"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">*</literal>
		<op />
	</operator>
	<operator name="divide" order="50" priority="210"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">/</literal>
		<op />
	</operator>
	<operator name="modulo" order="50" priority="210"
		impl="prisms.lang.types.ParsedBinaryOp">
		<pre-op />
		<literal storeAs="name">%</literal>
		<op />
	</operator>

	<!-- Unary pre -->
	<operator name="posit" order="50" priority="220"
		impl="prisms.lang.types.ParsedUnaryOp">
		<literal storeAs="name">+</literal>
		<op />
	</operator>
	<operator name="negate" order="50" priority="220"
		impl="prisms.lang.types.ParsedUnaryOp">
		<literal storeAs="name">-</literal>
		<op />
	</operator>
	<operator name="not" order="50" priority="220"
		impl="prisms.lang.types.ParsedUnaryOp">
		<literal storeAs="name">!</literal>
		<op />
	</operator>
	<!-- Others -->
	<operator name="parenthetic" order="50" priority="250"
		impl="prisms.lang.types.ParsedParenthetic">
		<literal>(</literal>
		<op storeAs="content" />
		<literal>)</literal>
	</operator>
</grammar>
